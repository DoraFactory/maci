<!DOCTYPE html>
<html>

<head>
    <title>MACI Bridge å¿«é€ŸéªŒè¯</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
        }

        button {
            padding: 10px 20px;
            margin: 5px;
        }
    </style>
</head>

<body>
    <h1>ğŸš€ MACI Bridge å¿«é€ŸéªŒè¯</h1>

    <div id="status">åŠ è½½ä¸­...</div>

    <button onclick="quickTest()">å¿«é€Ÿæµ‹è¯•</button>

    <div id="results"></div>

    <script src="./dist/maci-bridge.js"></script>
    <script>
        function updateStatus(message, type = 'success') {
            document.getElementById('status').innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function addResult(message, type = 'success') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            document.getElementById('results').appendChild(div);
        }

        async function quickTest() {
            addResult('å¼€å§‹æµ‹è¯•...');

            try {
                // æ£€æŸ¥ MaciBridge æ˜¯å¦å­˜åœ¨
                if (typeof window.MaciBridge === 'undefined') {
                    throw new Error('MaciBridge æœªå®šä¹‰');
                }
                addResult('âœ… MaciBridge å¯¹è±¡å­˜åœ¨');

                // æ£€æŸ¥æ‰€æœ‰æ–¹æ³•
                const methods = ['initialize', 'signup', 'publishMessage', 'generateProof', 'getState'];
                for (const method of methods) {
                    if (typeof window.MaciBridge[method] !== 'function') {
                        throw new Error(`æ–¹æ³• ${method} ä¸å­˜åœ¨æˆ–ä¸æ˜¯å‡½æ•°`);
                    }
                }
                addResult('âœ… æ‰€æœ‰æ–¹æ³•éƒ½å­˜åœ¨');

                // æµ‹è¯•åˆå§‹åŒ–
                await window.MaciBridge.initialize({ test: true });
                addResult('âœ… åˆå§‹åŒ–æˆåŠŸ');

                // æµ‹è¯•æ³¨å†Œ
                const signupResult = await window.MaciBridge.signup({
                    pubKey: 'test-key',
                    stateIndex: 1,
                    voiceCreditBalance: 100
                });
                addResult(`âœ… æ³¨å†Œæµ‹è¯•æˆåŠŸ: ${JSON.stringify(signupResult)}`);

                updateStatus('ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼', 'success');

            } catch (error) {
                addResult(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                updateStatus(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½åè‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', function () {
            if (typeof window.MaciBridge !== 'undefined') {
                updateStatus('âœ… MaciBridge å·²åŠ è½½ï¼Œç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•', 'success');
            } else {
                updateStatus('âŒ MaciBridge æœªåŠ è½½', 'error');
            }
        });
    </script>
</body>

</html>